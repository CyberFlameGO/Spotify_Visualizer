(function(e){function t(t){for(var a,i,o=t[0],c=t[1],l=t[2],u=0,h=[];u<o.length;u++)i=o[u],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&h.push(n[i][0]),n[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);d&&d(t);while(h.length)h.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],a=!0,i=1;i<s.length;i++){var o=s[i];0!==n[o]&&(a=!1)}a&&(r.splice(t--,1),e=c(c.s=s[0]))}return e}var a={},i={app:0},n={app:0},r=[];function o(e){return c.p+"js/"+({Community:"Community",about:"about"}[e]||e)+"."+{Community:"35066d30",about:"c6e6337b","chunk-2d0d63f1":"9de07e2f"}[e]+".js"}function c(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,c),s.l=!0,s.exports}c.e=function(e){var t=[],s={Community:1};i[e]?t.push(i[e]):0!==i[e]&&s[e]&&t.push(i[e]=new Promise((function(t,s){for(var a="css/"+({Community:"Community",about:"about"}[e]||e)+"."+{Community:"8ba5ffa6",about:"31d6cfe0","chunk-2d0d63f1":"31d6cfe0"}[e]+".css",n=c.p+a,r=document.getElementsByTagName("link"),o=0;o<r.length;o++){var l=r[o],u=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(u===a||u===n))return t()}var h=document.getElementsByTagName("style");for(o=0;o<h.length;o++){l=h[o],u=l.getAttribute("data-href");if(u===a||u===n)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var a=t&&t.target&&t.target.src||n,r=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=a,delete i[e],d.parentNode.removeChild(d),s(r)},d.href=n;var f=document.getElementsByTagName("head")[0];f.appendChild(d)})).then((function(){i[e]=0})));var a=n[e];if(0!==a)if(a)t.push(a[2]);else{var r=new Promise((function(t,s){a=n[e]=[t,s]}));t.push(a[2]=r);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,c.nc&&u.setAttribute("nonce",c.nc),u.src=o(e);var h=new Error;l=function(t){u.onerror=u.onload=null,clearTimeout(d);var s=n[e];if(0!==s){if(s){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;h.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",h.name="ChunkLoadError",h.type=a,h.request=i,s[1](h)}n[e]=void 0}};var d=setTimeout((function(){l({type:"timeout",target:u})}),12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(t)},c.m=e,c.c=a,c.d=function(e,t,s){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(c.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(s,a,function(t){return e[t]}.bind(null,a));return s},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var h=0;h<l.length;h++)t(l[h]);var d=u;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("cd49")},"00a3":function(e,t,s){"use strict";s.d(t,"e",(function(){return c})),s.d(t,"d",(function(){return u})),s.d(t,"c",(function(){return h})),s.d(t,"b",(function(){return d})),s.d(t,"a",(function(){return f}));s("d3b7");var a=s("bc3a"),i=s.n(a),n=s("8aa5"),r=s.n(n),o={apiKey:"AIzaSyBARk3BcjSSYFGe3LkDQAu1H-6VMxrolNM",authDomain:"tessellator-space.firebaseapp.com",databaseURL:"https://tessellator-space.firebaseio.com",projectId:"tessellator-space",storageBucket:"tessellator-space.appspot.com",messagingSenderId:"1095910844942",appId:"1:1095910844942:web:1a329d270ba9ed1c05aa5f"};r.a.initializeApp(o);var c={firebase:r.a};function l(e,t){var s=e.user.uid,a=r.a.database().ref("users/".concat(s,"/connections")),i=r.a.database().ref("users/".concat(s,"/lastOnline")),n=r.a.database().ref("users/".concat(s,"/spotifyLink"));n.set(t);var o=r.a.database().ref(".info/connected");o.on("value",(function(e){!0===e.val()&&(a.onDisconnect().remove(),a.set(s),console.log(s+" is online"),i.onDisconnect().set(r.a.database.ServerValue.TIMESTAMP))}))}function u(e){return new Promise((function(t,s){i.a.post("/authUser",e).then((function(a){console.log("Sent user id: ".concat(e.id," to server")),r.a.auth().signInWithCustomToken(a.data).then((function(s){l(s,e.external_urls.spotify),t(!0)})).catch((function(e){s(e)}))}))}))}function h(e){i.a.post("/addUser",{userData:e}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}function d(e,t){i.a.post("/addTrackPlayed",{trackData:e,userID:t}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}function f(e,t){i.a.post("/addArtistsPlayed",{artistsData:e.artists,userID:t}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},"018c":function(e,t,s){},"034f":function(e,t,s){"use strict";var a=s("85ec"),i=s.n(a);i.a},"074a":function(e,t,s){"use strict";var a=s("9eaf"),i=s.n(a);i.a},"1e54":function(e,t,s){"use strict";var a=s("f7f0"),i=s.n(a);i.a},"34ee":function(e,t,s){},4152:function(e,t,s){"use strict";s.d(t,"c",(function(){return a})),s.d(t,"b",(function(){return i})),s.d(t,"a",(function(){return n}));s("99af"),s("4de4"),s("d81d"),s("ac1f"),s("1276"),s("498a");function a(e,t){var s=new Date,a=t;s.setTime(s.getTime()+6048e5),document.cookie="".concat(e,"=").concat(a,";expires=").concat(s.toUTCString(),";path=/")}function i(e){var t=e.length+1;return document.cookie.split(";").map((function(e){return e.trim()})).filter((function(s){return s.substring(0,t)==="".concat(e,"=")})).map((function(e){return decodeURIComponent(e.substring(t))}))[0]||null}function n(e){var t=new Date;t.setTime(t.getTime()+-864e5),document.cookie="".concat(e,"=;expires=").concat(t.toUTCString(),";path=/")}},"42ef":function(e,t,s){"use strict";var a=s("f124"),i=s.n(a);i.a},4342:function(e,t,s){"use strict";var a=s("8e98"),i=s.n(a);i.a},"67c3":function(e,t,s){},"796c":function(e,t,s){},"7cf8":function(e,t,s){},"836e":function(e,t,s){"use strict";var a=s("018c"),i=s.n(a);i.a},"85ec":function(e,t,s){},"8e98":function(e,t,s){},"998b":function(e,t,s){"use strict";var a=s("fc3e"),i=s.n(a);i.a},"9eaf":function(e,t,s){},a3f4:function(e,t,s){},badc:function(e,t,s){},bf15:function(e,t,s){"use strict";var a=s("a3f4"),i=s.n(a);i.a},c2b5:function(e,t,s){"use strict";var a=s("7cf8"),i=s.n(a);i.a},cd49:function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("div",{attrs:{id:"nav"}},[s("router-link",{attrs:{to:"/"}},[e._v("Home")]),e._v(" | "),s("router-link",{attrs:{to:"/about"}},[e._v("About")]),e._v(" | "),s("router-link",{attrs:{to:"/dashboard"}},[e._v("Dashboard")]),e._v(" | "),s("router-link",{attrs:{to:"/community"}},[e._v("Community")])],1),s("router-view")],1)},n=[],r=(s("034f"),s("2877")),o={},c=Object(r["a"])(o,i,n,!1,null,null,null),l=c.exports,u=(s("d3b7"),s("8c4f")),h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"home"},[this.$store.state.authUser?s("Player"):e._e(),this.$store.state.openVisualizer?s("div",[this.$store.state.openVisualizer?s("div",[this.$store.state.playerInfo?s("VisualizerCanvas"):e._e(),this.$store.state.modeKey?s("VisualizerControls"):e._e()],1):e._e()]):s("div",[s("Login",{key:this.$store.state.accessToken}),this.$store.state.playerInfo?s("div",[s("transition-group",{staticClass:"home-container",attrs:{name:"fade"}},[this.$store.state.user?s("OnlineUsers",{key:this.$store.state.authUser}):e._e(),this.$store.state.authUser?s("MyPlaylists",{key:"myPlaylistsContainer"}):e._e()],1)],1):e._e()],1)],1)},d=[],f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("transition",{attrs:{name:"fade",mode:"out-in"}},[this.user?s("div",{key:"LoginTrue"},[s("h1",[e._v("hello, "+e._s(this.user.display_name)+"_")]),s("transition",{attrs:{name:"fade",mode:"out-in"}},[this.SpotifyAnalysisUtils&&this.SpotifyAnalysisUtils.loaded?s("div",{key:"OpenVisualizer",staticClass:"visualizer-button-container"},[s("button",{staticClass:"btn secondary",on:{click:e.openVis}},[e._v("open visualizer")])]):s("div",{key:"LoadingVisualizer",staticClass:"visualizer-button-container"},[s("breeding-rhombus-spinner",{attrs:{"animation-duration":2e3,size:64,color:"#FFF"}}),s("p",{staticClass:"loading"},[e._v("loading visualizer")])],1)])],1):s("div",{key:"LoginFalse"},[s("h1",[e._v("Welcome Home")]),s("button",{staticClass:"btn secondary",attrs:{href:"/login"}},[e._v("Login")]),s("h4",[e._v("A 3D interactive music visualizer.")])])])],1)},g=[],y=s("d4ec"),m=s("bee2"),v=s("2caf"),b=s("262e"),p=s("9ab4"),k=s("60a3"),O=s("4152"),j=s("00a3"),A=s("4583"),_=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){return Object(y["a"])(this,s),t.apply(this,arguments)}return Object(m["a"])(s,[{key:"openVis",value:function(){this.$store.commit("mutateOpenVisualizer",!0)}},{key:"created",value:function(){var e=this;this.$store.commit("mutateAccessToken",Object(O["b"])("accessToken")),this.$store.commit("mutateRefreshToken",Object(O["b"])("refreshToken")),k["c"].axios.get("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer "+this.$store.state.accessToken}}).then((function(t){console.log(t),e.$store.commit("mutateUser",t.data),e.$store.dispatch("actionAuthUser",t.data),e.updateGtagUserID(t.data.id)})).catch((function(t){console.log(t),e.refreshAccessToken()}))}},{key:"refreshAccessToken",value:function(){var e=this;k["c"].axios.post("/refreshToken",{refreshToken:this.$store.state.refreshToken}).then((function(t){Object(O["c"])("accessToken",t.data.access_token),e.$store.commit("mutateAccessToken",Object(O["b"])("accessToken"))})).catch(console.log)}},{key:"updateGtagUserID",value:function(e){this.$gtag.set({user_id:e}),this.$gtag.pageview({page_title:"Login",page_path:"/login",page_location:"/login"})}},{key:"onUserChanged",value:function(e,t){null!==JSON.stringify(e)&&JSON.stringify(t)!==JSON.stringify(e)&&(console.log(!1),Object(j["c"])(e))}},{key:"user",get:function(){return this.$store.state.user}},{key:"accessToken",get:function(){return this.$store.state.accessToken}},{key:"playerInfo",get:function(){return this.$store.state.playerInfo}},{key:"SpotifyAnalysisUtils",get:function(){return this.$store.state.spotifyAnalysisUtils}}]),s}(k["c"]);Object(p["__decorate"])([Object(k["d"])("user")],_.prototype,"onUserChanged",null),_=Object(p["__decorate"])([Object(k["a"])({components:{BreedingRhombusSpinner:A["a"]}})],_);var C=_,T=C,D=(s("bf15"),Object(r["a"])(T,f,g,!1,null,"4b02e379",null)),P=D.exports,w=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"home-container-child"},[s("div",{staticClass:"online-users-title"},[s("transition",{attrs:{name:"fade",mode:"out-in"}},[e.onlineUsers?s("div",[s("h3",[e._v("Online Users "),s("i",[e._v("("+e._s(e.onlineUsers.size)+")")])])]):e.lastOnlineUsers?s("div",[s("h3",[e._v("Last Online Users")])]):s("div",[s("h3",[e._v("Online Users "),s("i",[e._v("(?)")])]),s("fingerprint-spinner",{attrs:{"animation-duration":1500,size:64,color:"#FFF"}})],1)])],1),s("div",{staticClass:"users-container"},[s("transition",{attrs:{name:"fadeRight",mode:"out-in"}},[e.onlineUsers?s("div",{key:"onlineUsersContainer"},e._l(e.onlineUsers.values(),(function(e){return s("div",{key:e.user,staticClass:"each-user"},[s("OnlineItem",{attrs:{onlineUser:e}}),s("LastPlayedItem",{attrs:{trackDetails:e.lastPlayed}}),s("UserPlaylists",{attrs:{userID:e.user}})],1)})),0):e.lastOnlineUsers?s("div",{key:"lastOnlineUsersContainer"},e._l(Array.from(e.lastOnlineUsers.values()).reverse(),(function(e,t){return s("div",{key:e.user+t,staticClass:"each-user"},[s("LastOnlineItem",{attrs:{lastOnlineUser:e}}),s("LastPlayedItem",{attrs:{trackDetails:e.lastPlayed}}),s("UserPlaylists",{attrs:{userID:e.user}})],1)})),0):s("div",[s("p",[e._v("no users")])])])],1)])},$=[],U=(s("4160"),s("4ec9"),s("3ca3"),s("159b"),s("ddb0"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.trackDetails?s("div",{staticClass:"item"},[s("a",{attrs:{href:e.trackDetails.external_urls.spotify,target:"_blank"}},[e._v(" "+e._s(e.trackDetails.name)+" ")]),e._v(" by "),s("a",{attrs:{href:e.trackDetails.artists[0].external_urls.spotify,target:"_blank"}},[e._v(" "+e._s(e.trackDetails.artists[0].name)+" ")])]):e._e()}),M=[],S=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){var e;return Object(y["a"])(this,s),e=t.call(this),console.log(e.trackDetails),e}return s}(k["c"]);Object(p["__decorate"])([Object(k["b"])({required:!0})],S.prototype,"trackDetails",void 0),S=Object(p["__decorate"])([k["a"]],S);var x=S,I=x,E=Object(r["a"])(I,U,M,!1,null,"94bcf5e2",null),z=E.exports,R=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.lastOnlineUser?s("div",{staticClass:"item"},[s("a",{key:e.calculatedTime,attrs:{href:e.lastOnlineUser.spotifyLink,target:"_blank"}},[e._v(" "+e._s(e.lastOnlineUser.user)+" was last online "+e._s(e.calculatedTime)+" ")])]):e._e()},F=[],L=(s("25f0"),function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){var e;return Object(y["a"])(this,s),e=t.call(this),e.calcTime(),e}return Object(m["a"])(s,[{key:"destroyed",value:function(){this.stopTrackTimer()}},{key:"stopTrackTimer",value:function(){clearInterval(this.timerRef)}},{key:"calcTime",value:function(){var e=(new Date).getTime(),t=new Date(this.lastOnlineUser.lastOnline).getTime(),s=Math.floor((e-t)/6e4);this.calculatedTime=s>1440?Math.floor(s/1440).toString()+" days ago":s>60?Math.floor(s/60).toString()+" hours ago":s.toString()+" mins ago",console.log("changed time to "+s),this.timerRef=setTimeout(this.calcTime,6e4)}}]),s}(k["c"]));Object(p["__decorate"])([Object(k["b"])({required:!0})],L.prototype,"lastOnlineUser",void 0),L=Object(p["__decorate"])([k["a"]],L);var q=L,K=q,V=Object(r["a"])(K,R,F,!1,null,"2e89bdbe",null),B=V.exports,H=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.onlineUser?s("div",{staticClass:"item"},[s("a",{attrs:{href:e.onlineUser.spotifyLink,target:"_blank"}},[s("strong",[e._v(" "+e._s(e.onlineUser.user)+" is online ")])])]):e._e()},W=[],Z=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){var e;return Object(y["a"])(this,s),e=t.call(this),console.log(e.onlineUser),e}return s}(k["c"]);Object(p["__decorate"])([Object(k["b"])({required:!0})],Z.prototype,"onlineUser",void 0),Z=Object(p["__decorate"])([k["a"]],Z);var N=Z,G=N,J=Object(r["a"])(G,H,W,!1,null,"247f4448",null),X=J.exports,Y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"item"},[s("transition",{attrs:{name:"fadeUp",mode:"out-in"}},[this.usersPlaylists.get(e.userID)?s("div",{key:"close{{userID}}Playlists",staticClass:"playlists-container"},[e._l(this.usersPlaylists.get(e.userID),(function(t){return s("div",{key:e.userID+t.id},[s("UserPlaylist",{attrs:{playlistDetails:t,userID:e.userID}})],1)})),s("button",{staticClass:"btn secondary",on:{click:function(t){return e.hideUserPlaylists(e.userID)}}},[e._v("Hide "+e._s(e.userID)+"'s playlists")])],2):s("div",{key:"open{{userID}}Playlists"},[s("button",{staticClass:"btn primary",on:{click:function(t){return e.getOnlineUserPlaylists(e.userID)}}},[e._v("load "+e._s(e.userID)+"'s playlists")])])])],1)},Q=[],ee=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.playlistDetails?s("div",{staticClass:"playlist-item"},[s("a",{attrs:{href:e.playlistDetails.external_urls.spotify,target:"_blank"}},[e._v(" "+e._s(e.playlistDetails.name)+" ")]),s("i",{staticClass:"icon play",on:{click:function(t){return e.playPlaylist(e.deviceID,e.playlistDetails.uri)}}})]):e._e()},te=[],se=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){return Object(y["a"])(this,s),t.apply(this,arguments)}return Object(m["a"])(s,[{key:"playPlaylist",value:function(e,t){console.log(t),console.log(e),k["c"].axios.put("https://api.spotify.com/v1/me/player/play?device_id=".concat(e),{context_uri:t},{headers:{Authorization:"Bearer "+this.$store.state.accessToken}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"deviceID",get:function(){return this.$store.state.deviceID}}]),s}(k["c"]);Object(p["__decorate"])([Object(k["b"])({required:!0})],se.prototype,"playlistDetails",void 0),Object(p["__decorate"])([Object(k["b"])({required:!0})],se.prototype,"userID",void 0),se=Object(p["__decorate"])([k["a"]],se);var ae=se,ie=ae,ne=(s("42ef"),Object(r["a"])(ie,ee,te,!1,null,"bbecfe92",null)),re=ne.exports,oe=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){return Object(y["a"])(this,s),t.apply(this,arguments)}return Object(m["a"])(s,[{key:"hideUserPlaylists",value:function(e){console.log("hiding ".concat(e,"'s playlists")),this.$store.commit("mutateUsersPlaylists",{key:e,value:!1})}},{key:"getOnlineUserPlaylists",value:function(e){var t=this;console.log("getting ".concat(e,"'s playlists")),k["c"].axios.get("https://api.spotify.com/v1/users/".concat(e,"/playlists?limit=5"),{headers:{Authorization:"Bearer "+this.$store.state.accessToken}}).then((function(s){console.log(s),t.$store.commit("mutateUsersPlaylists",{key:e,value:s.data.items,next:s.data.next})})).catch((function(e){console.log(e)}))}},{key:"usersPlaylists",get:function(){return this.$store.state.usersPlaylists}}]),s}(k["c"]);Object(p["__decorate"])([Object(k["b"])({required:!0})],oe.prototype,"userID",void 0),oe=Object(p["__decorate"])([Object(k["a"])({components:{UserPlaylist:re}})],oe);var ce=oe,le=ce,ue=(s("d235"),Object(r["a"])(le,Y,Q,!1,null,"52e97771",null)),he=ue.exports,de=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){return Object(y["a"])(this,s),t.apply(this,arguments)}return Object(m["a"])(s,[{key:"created",value:function(){this.$nextTick((function(){this.loadOnline(),this.loadLastOnline()}))}},{key:"hideUserPlaylists",value:function(e){console.log("hiding ".concat(e,"'s playlists")),this.$store.commit("mutateUsersPlaylists",{key:e,value:!1})}},{key:"getOnlineUserPlaylists",value:function(e){var t=this;console.log("getting ".concat(e,"'s playlists")),console.log(e),k["c"].axios.get("https://api.spotify.com/v1/users/".concat(e,"/playlists"),{headers:{Authorization:"Bearer "+this.$store.state.accessToken}}).then((function(s){console.log(s.data.items);var a={key:e,value:s.data.items};t.$nextTick().then((function(){t.$store.commit("mutateUsersPlaylists",a)}))})).catch((function(e){console.log(e)}))}},{key:"loadOnline",value:function(){var e=this,t=new Map;j["e"].firebase.database().ref("users/").on("value",(function(s){t.clear(),s.forEach((function(s){if(e.user.id!==s.key){var a={user:s.child("connections").val(),spotifyLink:s.child("spotifyLink").val(),lastPlayed:s.child("lastPlayed").val()};a.user?t.set(a.user,a):t.delete(a.user)}})),0===t.size?(e.$store.commit("mutateOnlineUsers",null),e.loadLastOnline()):e.$store.commit("mutateOnlineUsers",t),console.log(t)}))}},{key:"loadLastOnline",value:function(){var e=this,t=new Map;j["e"].firebase.database().ref("users/").orderByChild("lastOnline").on("value",(function(s){t.clear(),s.forEach((function(s){if(e.user.id!==s.key){var a={user:s.key,spotifyLink:s.child("spotifyLink").val(),lastPlayed:s.child("lastPlayed").val(),lastOnline:s.child("lastOnline").val()};t.set(a.user,a)}})),e.$store.commit("mutateLastOnlineUsers",t)}))}},{key:"user",get:function(){return this.$store.state.user}},{key:"onlineUsers",get:function(){return this.$store.getters.getOnlineUsers}},{key:"lastOnlineUsers",get:function(){return this.$store.getters.getLastOnlineUsers}},{key:"usersPlaylists",get:function(){return this.$store.getters.getUsersPlaylists}},{key:"toggleUsersPlaylists",get:function(){return this.$store.state.toggleUsersPlaylists}}]),s}(k["c"]);de=Object(p["__decorate"])([Object(k["a"])({components:{LastPlayedItem:z,LastOnlineItem:B,OnlineItem:X,UserPlaylists:he,FingerprintSpinner:A["b"]}})],de);var fe=de,ge=fe,ye=(s("c2b5"),Object(r["a"])(ge,w,$,!1,null,"011dae5e",null)),me=ye.exports,ve=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"fadeUp"}},[this.accessToken&&this.playerInfo?s("div",{staticClass:"player-container"},[s("transition",{attrs:{name:"fadeDown",mode:"out-in"}},[this.hidePlayerToggle?s("div",{key:"HiddenPlayerContainer",staticClass:"hidden-bar-container"},[s("div",[s("a",{on:{click:e.showPlayer}},[e._v("show player")])])]):s("div",{key:"OpenPlayerContainer",staticClass:"player-bar-container"},[s("div",{staticClass:"hideToggle"},[s("a",{on:{click:e.hidePlayer}},[e._v("hide player")])]),s("div",{staticClass:"player-bar"},[s("TrackItem",{attrs:{trackDetails:this.playerInfo.track_window.current_track}}),s("PlayerControls")],1)])]),s("div",{staticClass:"player-progress",class:[this.hidePlayerToggle?"off":"on"]},[s("SeekTrack",{attrs:{playerInfo:this.playerInfo}})],1)],1):e._e()])},be=[],pe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.trackDetails?s("div",{staticClass:"now-playing-left-container"},[s("div",{staticClass:"now-playing-left"},[s("div",{staticClass:"track-details"},[s("div",{staticClass:"track-name"},[s("a",{attrs:{href:e.convertURItoURL(e.trackDetails.uri),target:"_blank"}},[e._v(" "+e._s(e.trackDetails.name)+" ")])]),s("div",{staticClass:"artist-name"},[s("a",{attrs:{href:e.convertURItoURL(e.trackDetails.artists[0].uri),target:"_blank"}},[e._v(" "+e._s(e.trackDetails.artists[0].name)+" ")])])])])]):e._e()},ke=[],Oe=(s("ac1f"),s("1276"),function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){var e;return Object(y["a"])(this,s),e=t.call(this),console.log(e.trackDetails),e}return Object(m["a"])(s,[{key:"convertURItoURL",value:function(e){var t=e.split(":"),s="https://open.spotify.com/";return 3===t.length&&(s+=t[1]+"/",s+=t[2]),s}}]),s}(k["c"]));Object(p["__decorate"])([Object(k["b"])({required:!0})],Oe.prototype,"trackDetails",void 0),Oe=Object(p["__decorate"])([k["a"]],Oe);var je=Oe,Ae=je,_e=(s("998b"),Object(r["a"])(Ae,pe,ke,!1,null,"691ffafe",null)),Ce=_e.exports,Te=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"now-playing-center-container"},[s("div",{staticClass:"now-playing-center"},[s("div",[e._v(" "+e._s(e.millisToMinutesAndSeconds(e.trackPosition))+" ")]),s("div",{staticClass:"slider",on:{click:e.barClick}},[s("div",{ref:"sliderRef",staticClass:"slider-bar"},[s("div",{staticClass:"slider-handle",style:{left:this.position+"px"},on:{mousedown:function(t){return e.dragStart(t,0)}}}),s("div",{staticClass:"slider-process",style:{width:this.position+"px"}})])]),s("div",[e._v(" "+e._s(e.millisToMinutesAndSeconds(e.playerInfo.duration))+" ")])])])},De=[],Pe=(s("b680"),function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){return Object(y["a"])(this,s),t.apply(this,arguments)}return Object(m["a"])(s,[{key:"data",value:function(){return{position:0,timer:null,dragging:!1,sliderWidth:0,offset:null}}},{key:"created",value:function(){var e=this;this.$nextTick((function(){e.$data.sliderWidth=e.$refs.sliderRef.clientWidth,e.$data.offset=e.$refs.sliderRef.getBoundingClientRect().left,e.bindListener(),e.trackTimer()}))}},{key:"destroyed",value:function(){this.stopTrackTimer()}},{key:"millisToMinutesAndSeconds",value:function(e){var t=Math.floor(e/6e4),s=(e%6e4/1e3).toFixed(0);return t+":"+(parseInt(s)<10?"0":"")+s}},{key:"bindListener",value:function(){document.addEventListener("mousemove",this.drag),document.addEventListener("mouseup",this.dragEnd)}},{key:"setPosition",value:function(e){this.$data.position=e}},{key:"barClick",value:function(e){var t=this.getPosition(e),s=this.getTrackPosition(e);this.setPosition(t),this.seekPlayerPosition(this.accessToken,s),this.$store.commit("mutateTrackPosition",s)}},{key:"dragStart",value:function(){this.$data.dragging=!0}},{key:"drag",value:function(e){if(this.$data.dragging){var t=this.getPosition(e),s=this.getTrackPosition(e);t>0&&t<this.$data.sliderWidth&&(this.setPosition(t),this.$store.commit("mutateTrackPosition",s))}}},{key:"dragEnd",value:function(e){this.$data.dragging&&(this.seekPlayerPosition(this.accessToken,this.trackPosition),this.$data.dragging=!1)}},{key:"getPosition",value:function(e){return e.clientX-this.$data.offset}},{key:"getTrackPosition",value:function(e){return Math.floor((e.clientX-this.$data.offset)/this.$data.sliderWidth*this.playerInfo.duration)}},{key:"seekPlayerPosition",value:function(e,t){console.log("=== seek player ===="),k["c"].axios.put("https://api.spotify.com/v1/me/player/seek?position_ms=".concat(t),{},{headers:{Authorization:"Bearer "+e}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"stopTrackTimer",value:function(){clearInterval(this.timerRef)}},{key:"trackTimer",value:function(){var e=this,t=(new Date).getTime();this.timerRef=setTimeout((function(){var s=(new Date).getTime()-t;e.playerInfo.paused||e.$store.commit("mutateTrackPosition",e.trackPosition+s),e.trackTimer()}),10)}},{key:"onTrackPositionChanged",value:function(e,t){e>=0&&(this.setPosition(Math.floor(e/this.playerInfo.duration*this.$data.sliderWidth)),this.SpotifyAnalysisUtils.changeAnalysis(e))}},{key:"onPlayerInfoChanged",value:function(e,t){e&&this.$store.commit("mutateTrackPosition",e.position)}},{key:"accessToken",get:function(){return this.$store.state.accessToken}},{key:"trackPosition",get:function(){return this.$store.state.trackPosition}},{key:"SpotifyAnalysisUtils",get:function(){return this.$store.state.spotifyAnalysisUtils}}]),s}(k["c"]));Object(p["__decorate"])([Object(k["b"])({required:!0})],Pe.prototype,"playerInfo",void 0),Object(p["__decorate"])([Object(k["d"])("trackPosition")],Pe.prototype,"onTrackPositionChanged",null),Object(p["__decorate"])([Object(k["d"])("playerInfo")],Pe.prototype,"onPlayerInfoChanged",null),Pe=Object(p["__decorate"])([k["a"]],Pe);var we=Pe,$e=we,Ue=(s("074a"),Object(r["a"])($e,Te,De,!1,null,"2ab62756",null)),Me=Ue.exports,Se=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.playerInfo?s("div",{staticClass:"now-playing-right-container"},[s("div",{staticClass:"now-playing-right"},[s("div",{staticClass:"player-controls"},[s("TogglePrev"),s("TogglePausePlay",{attrs:{isPaused:e.playerInfo.paused}}),s("ToggleNext"),s("ToggleShuffle",{attrs:{isShuffle:e.playerInfo.shuffle}}),s("SaveTrack",{attrs:{trackID:e.playerInfo.track_window.current_track.id}})],1)])]):e._e()},xe=[],Ie=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.isPaused?s("div",{staticClass:"button-container"},[s("i",{staticClass:"icon play",on:{click:function(t){return e.playPlayer(e.accessToken)}}})]):s("div",{staticClass:"button-container"},[s("i",{staticClass:"icon pause",on:{click:function(t){return e.pausePlayer(e.accessToken)}}})])},Ee=[],ze=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){return Object(y["a"])(this,s),t.apply(this,arguments)}return Object(m["a"])(s,[{key:"pausePlayer",value:function(e){console.log("=== pausing player ===="),k["c"].axios.put("https://api.spotify.com/v1/me/player/pause",{},{headers:{Authorization:"Bearer "+e}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"playPlayer",value:function(e){console.log("=== playing player ===="),k["c"].axios.put("https://api.spotify.com/v1/me/player/play",{},{headers:{Authorization:"Bearer "+e}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"accessToken",get:function(){return this.$store.state.accessToken}}]),s}(k["c"]);Object(p["__decorate"])([Object(k["b"])({required:!0})],ze.prototype,"isPaused",void 0),ze=Object(p["__decorate"])([k["a"]],ze);var Re=ze,Fe=Re,Le=Object(r["a"])(Fe,Ie,Ee,!1,null,"ba6840ae",null),qe=Le.exports,Ke=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.isShuffle?s("div",[s("i",{staticClass:"icon shuffle on",on:{click:function(t){return e.toggleShuffle(e.accessToken)}}})]):s("div",[s("i",{staticClass:"icon shuffle",on:{click:function(t){return e.toggleShuffle(e.accessToken)}}})])])},Ve=[],Be=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){return Object(y["a"])(this,s),t.apply(this,arguments)}return Object(m["a"])(s,[{key:"toggleShuffle",value:function(e){console.log("=== shuffle player ===="),k["c"].axios.put("https://api.spotify.com/v1/me/player/shuffle?state=".concat(!this.isShuffle),{},{headers:{Authorization:"Bearer "+e}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"accessToken",get:function(){return this.$store.state.accessToken}}]),s}(k["c"]);Object(p["__decorate"])([Object(k["b"])({required:!0})],Be.prototype,"isShuffle",void 0),Be=Object(p["__decorate"])([k["a"]],Be);var He=Be,We=He,Ze=Object(r["a"])(We,Ke,Ve,!1,null,"5d6a3951",null),Ne=Ze.exports,Ge=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.isRepeat?s("div",[s("button",{on:{click:function(t){return e.toggleRepeat(e.accessToken)}}},[e._v("Don't Repeat Player")])]):s("div",[s("button",{on:{click:function(t){return e.toggleRepeat(e.accessToken)}}},[e._v("Repeat Player")])])])},Je=[],Xe=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){return Object(y["a"])(this,s),t.apply(this,arguments)}return Object(m["a"])(s,[{key:"toggleRepeat",value:function(e){console.log("=== repeat player ===="),k["c"].axios.put("https://api.spotify.com/v1/me/player/repeat?state=".concat(!this.isRepeat),{},{headers:{Authorization:"Bearer "+e}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"accessToken",get:function(){return this.$store.state.accessToken}}]),s}(k["c"]);Object(p["__decorate"])([Object(k["b"])({required:!0})],Xe.prototype,"isRepeat",void 0),Xe=Object(p["__decorate"])([k["a"]],Xe);var Ye=Xe,Qe=Ye,et=Object(r["a"])(Qe,Ge,Je,!1,null,"3312b0ea",null),tt=et.exports,st=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"button-container"},[s("i",{staticClass:"icon prev",on:{click:function(t){return e.prevTrack(e.accessToken)}}})])},at=[],it=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){return Object(y["a"])(this,s),t.apply(this,arguments)}return Object(m["a"])(s,[{key:"prevTrack",value:function(e){console.log("=== prev player ===="),k["c"].axios.post("https://api.spotify.com/v1/me/player/previous",{},{headers:{Authorization:"Bearer "+e}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"accessToken",get:function(){return this.$store.state.accessToken}}]),s}(k["c"]);it=Object(p["__decorate"])([k["a"]],it);var nt=it,rt=nt,ot=Object(r["a"])(rt,st,at,!1,null,"7ef99e15",null),ct=ot.exports,lt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"button-container"},[s("i",{staticClass:"icon next",on:{click:function(t){return e.nextTrack(e.accessToken)}}})])},ut=[],ht=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){return Object(y["a"])(this,s),t.apply(this,arguments)}return Object(m["a"])(s,[{key:"nextTrack",value:function(e){console.log("=== next player ===="),k["c"].axios.post("https://api.spotify.com/v1/me/player/next",{},{headers:{Authorization:"Bearer "+e}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"accessToken",get:function(){return this.$store.state.accessToken}}]),s}(k["c"]);ht=Object(p["__decorate"])([k["a"]],ht);var dt=ht,ft=dt,gt=Object(r["a"])(ft,lt,ut,!1,null,"5541ab4e",null),yt=gt.exports,mt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[this.$data.hasLikedTrack?s("div",[s("i",{staticClass:"icon heart on",on:{click:function(t){return e.unlikeTrack(e.accessToken)}}})]):s("div",[s("i",{staticClass:"icon heart",on:{click:function(t){return e.likeTrack(e.accessToken)}}})])])},vt=[],bt=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){return Object(y["a"])(this,s),t.apply(this,arguments)}return Object(m["a"])(s,[{key:"data",value:function(){return{hasLikedTrack:!1}}},{key:"mounted",value:function(){var e=this;this.$nextTick((function(){e.checkTrack(e.accessToken)}))}},{key:"checkTrack",value:function(e){var t=this;console.log("checking track ".concat(this.trackID)),k["c"].axios.get("https://api.spotify.com/v1/me/tracks/contains?ids=".concat(this.trackID),{headers:{Authorization:"Bearer "+e}}).then((function(e){console.log(e.data),t.$data.hasLikedTrack=e.data[0],console.log(t.$data.hasLikedTrack)})).catch((function(e){console.log(e)}))}},{key:"unlikeTrack",value:function(e){var t=this;console.log("=== unlike track ===="),k["c"].axios.delete("https://api.spotify.com/v1/me/tracks?ids=".concat(this.trackID),{headers:{Authorization:"Bearer "+e}}).then((function(e){console.log(e),t.checkTrack(t.accessToken)})).catch((function(e){console.log(e)}))}},{key:"likeTrack",value:function(e){var t=this;console.log("=== like track ===="),k["c"].axios.put("https://api.spotify.com/v1/me/tracks?ids=".concat(this.trackID),{},{headers:{Authorization:"Bearer "+e}}).then((function(e){console.log(e),t.checkTrack(t.accessToken)})).catch((function(e){console.log(e)}))}},{key:"onTrackIDChange",value:function(e,t){var s=this;this.$nextTick((function(){s.checkTrack(s.accessToken)}))}},{key:"accessToken",get:function(){return this.$store.state.accessToken}}]),s}(k["c"]);Object(p["__decorate"])([Object(k["b"])({required:!0})],bt.prototype,"trackID",void 0),Object(p["__decorate"])([Object(k["d"])("trackID")],bt.prototype,"onTrackIDChange",null),bt=Object(p["__decorate"])([k["a"]],bt);var pt=bt,kt=pt,Ot=(s("4342"),Object(r["a"])(kt,mt,vt,!1,null,"7069e323",null)),jt=Ot.exports,At=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){return Object(y["a"])(this,s),t.apply(this,arguments)}return Object(m["a"])(s,[{key:"accessToken",get:function(){return this.$store.state.accessToken}},{key:"playerInfo",get:function(){return this.$store.state.playerInfo}}]),s}(k["c"]);At=Object(p["__decorate"])([Object(k["a"])({components:{TogglePausePlay:qe,ToggleShuffle:Ne,ToggleRepeat:tt,TogglePrev:ct,ToggleNext:yt,SaveTrack:jt}})],At);var _t=At,Ct=_t,Tt=(s("836e"),Object(r["a"])(Ct,Se,xe,!1,null,"55d5de7e",null)),Dt=Tt.exports,Pt=s("bc3a"),wt=s.n(Pt),$t=function(){function e(){Object(y["a"])(this,e),this.resetTrackVariables(),this.changeColour=!1,this.changeMode=!1,this.loaded=!1}return Object(m["a"])(e,[{key:"getTrackFeaturesAnalysis",value:function(e,t){this.getTrackAnalysis(e,t),this.getTrackFeatures(e,t)}},{key:"getTrackFeatures",value:function(e,t){var s=this;console.log("=== track Features ===="),wt.a.get("https://api.spotify.com/v1/audio-features/".concat(t),{headers:{Authorization:"Bearer "+e}}).then((function(e){s.trackFeatures=e.data})).catch((function(a){console.log(a),401===a.code?vs.push({name:"Home"}):s.getTrackFeatures(e,t)}))}},{key:"getTrackAnalysis",value:function(e,t){var s=this;console.log("=== track Analysis ===="),wt.a.get("https://api.spotify.com/v1/audio-analysis/".concat(t),{headers:{Authorization:"Bearer "+e}}).then((function(e){s.trackAnalysis=e.data,s.setTrackAnalysisParts(e.data)})).catch((function(a){console.log(a),401===a.code?vs.push({name:"Home"}):s.getTrackAnalysis(e,t)}))}},{key:"changeAnalysis",value:function(e){e/=1e3,this.changeSection(e),this.changeBar(e),this.changeBeat(e),this.changeTatum(e),this.changeSegment(e)}},{key:"changeSection",value:function(e){if(this.g_sections[this.g_section]){var t=this.g_sections[this.g_section].start+this.g_sections[this.g_section].duration;e>t&&(this.changeMode=!0,this.g_section++)}}},{key:"changeBar",value:function(e){if(this.g_bars[this.g_bar]){var t=this.g_bars[this.g_bar].start+this.g_bars[this.g_bar].duration;if(e>t){var s=this.g_bars[this.g_bar].confidence;this.g_bar++,s>.5&&(console.log("## bar ##"),this.barCounter++,this.changeColour=!0)}}}},{key:"changeBeat",value:function(e){if(this.g_beats[this.g_beat]){var t=this.g_beats[this.g_beat].start+this.g_beats[this.g_beat].duration;if(e>t){var s=this.g_beats[this.g_beat].confidence;this.g_beat++,s>this.beatAv+this.beatVariance&&(console.log("## beat ##"),this.beatCounter++)}}}},{key:"changeTatum",value:function(e){if(this.g_tatums[this.g_tatum]){var t=this.g_tatums[this.g_tatum].start+this.g_tatums[this.g_tatum].duration;if(e>t){var s=this.g_tatums[this.g_tatum].confidence;this.g_tatum++,s>this.tatumAv-this.tatumVariance&&this.tatumCounter++}}}},{key:"changeSegment",value:function(e){if(this.g_segments[this.g_segment]){var t=this.g_segments[this.g_segment].start+this.g_segments[this.g_segment].duration;e>t&&(this.g_segment++,this.g_timbre=this.g_segments[this.g_segment].timbre,this.g_pitches=this.g_segments[this.g_segment].pitches)}}},{key:"setTrackAnalysisParts",value:function(e){this.resetTrackVariables(),this.setSections(e.sections),this.setBars(e.bars),this.setBeats(e.beats),this.setTatums(e.tatums),this.setSegments(e.segments),this.calculateTrackDeviation(),this.loaded=!0}},{key:"calculateBeatDeviation",value:function(){this.beatVariance=0,this.beatAv=this.g_beats[0].confidence;for(var e=0,t=1;t<this.g_beats.length;t++)e=this.g_beats[t].confidence-this.beatAv,this.beatAv+=e/this.g_beats.length,this.beatVariance+=e*(this.g_beats[t].confidence-this.beatAv);this.beatVariance=this.beatVariance/(this.g_beats.length-1),this.beatVariance=this.beatVariance*(1+this.trackFeatures.valence),console.log("beatAv = ".concat(this.beatAv)),console.log("beatVar = ".concat(this.beatVariance))}},{key:"calculateTatumDeviation",value:function(){this.tatumVariance=0,this.tatumAv=this.g_tatums[0].confidence;for(var e=0,t=1;t<this.g_tatums.length;t++)e=this.g_tatums[t].confidence-this.tatumAv,this.tatumAv+=e/this.g_tatums.length,this.tatumVariance+=e*(this.g_tatums[t].confidence-this.tatumAv);this.tatumVariance=this.tatumVariance/(this.g_tatums.length-1),this.tatumVariance=this.tatumVariance*(1.5+this.trackFeatures.valence),console.log("tatumAv = ".concat(this.tatumAv)),console.log("tatumVar = ".concat(this.tatumVariance))}},{key:"calculateTrackDeviation",value:function(){this.calculateBeatDeviation(),this.calculateTatumDeviation()}},{key:"resetTrackVariables",value:function(){this.g_sections=[],this.g_bars=[],this.g_beats=[],this.g_tatums=[],this.g_segments=[],this.g_section=0,this.g_bar=0,this.g_beat=0,this.g_tatum=0,this.g_segment=0,this.g_pitches=[],this.g_pitches=[],this.barCounter=0,this.beatCounter=0,this.tatumCounter=0,this.beatAv=0,this.beatVariance=0,this.tatumAv=0,this.tatumVariance=0}},{key:"setSections",value:function(e){this.g_sections=e}},{key:"setBars",value:function(e){this.g_bars=e}},{key:"setBeats",value:function(e){this.g_beats=e}},{key:"setTatums",value:function(e){this.g_tatums=e}},{key:"setSegments",value:function(e){this.g_segments=e}}]),e}(),Ut=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){var e;return Object(y["a"])(this,s),e=t.call(this),e.hidePlayerToggle=!1,e}return Object(m["a"])(s,[{key:"hidePlayer",value:function(){this.hidePlayerToggle=!0}},{key:"showPlayer",value:function(){this.hidePlayerToggle=!1}},{key:"created",value:function(){this.SpotifyAnalysisUtils||this.$store.commit("mutateSpotifyAnalysisUtils",new $t)}},{key:"mounted",value:function(){if(!document.getElementById("spotify-sdk")){var e=document.createElement("script");e.setAttribute("src","https://sdk.scdn.co/spotify-player.js"),e.id="spotify-sdk",e.async=!0,this.sdkInit(),document.head.appendChild(e)}}},{key:"addPlayerListeners",value:function(e){var t=this;e.addListener("initialization_error",(function(e){console.log("initialization_error"),console.log(e)})),e.addListener("authentication_error",(function(e){console.log("authentication_error"),console.log(e)})),e.addListener("account_error",(function(e){console.log("account_error"),console.log(e)})),e.addListener("playback_error",(function(e){console.log("playback_error"),console.log(e)})),e.addListener("ready",(function(e){console.log("Ready with deviceID ",e.device_id),t.$store.commit("mutateDeviceID",e.device_id),t.playRandomTrack(e.device_id)})),e.addListener("player_state_changed",(function(e){console.log("player state changed"),console.log(e),t.$store.commit("mutatePlayerInfo",e),e&&0===e.position&&(console.log(e),t.getPlayerTrack())}))}},{key:"sdkInit",value:function(){var e=this;console.log("sdkInit"),window.onSpotifyWebPlaybackSDKReady=function(){var t=new window.Spotify.Player({name:"Visualizer Player",getOAuthToken:function(t){t(e.$store.state.accessToken)}});e.addPlayerListeners(t),t.connect()}}},{key:"refreshAccessToken",value:function(){var e=this;k["c"].axios.post("/refreshToken",{refreshToken:this.$store.state.refreshToken}).then((function(t){Object(O["c"])("accessToken",t.data.access_token),e.$store.commit("mutateAccessToken",Object(O["b"])("accessToken"))}))}},{key:"play",value:function(e,t){var s=this;console.log(t),console.log(e),k["c"].axios.put("https://api.spotify.com/v1/me/player/play?device_id=".concat(e),{uris:[t]},{headers:{Authorization:"Bearer "+this.$store.state.accessToken}}).then((function(e){console.log(e)})).catch((function(e){console.log(e),s.refreshAccessToken()}))}},{key:"playRandomTrack",value:function(e){var t=this;k["c"].axios.get("https://api.spotify.com/v1/me/top/tracks",{headers:{Authorization:"Bearer "+this.$store.state.accessToken}}).then((function(s){var a=s.data.items[Math.floor(20*Math.random())].uri;t.play(e,a)}))}},{key:"getPlayerTrack",value:function(){var e=this;k["c"].axios.get("https://api.spotify.com/v1/me/player",{headers:{Authorization:"Bearer "+this.$store.state.accessToken}}).then((function(t){t.data&&(console.log("has new track DATA"),console.log(t.data),e.SpotifyAnalysisUtils?e.SpotifyAnalysisUtils.getTrackFeaturesAnalysis(e.accessToken,e.$store.state.playerInfo.track_window.current_track.id):console.log("SpotifyAnalysisUtils doesnt exist"),e.sendTrackData(t.data.item),Object(j["b"])(t.data.item,e.$store.state.user.id),Object(j["a"])(t.data.item,e.$store.state.user.id))})).catch((function(t){console.log(t),e.refreshAccessToken()}))}},{key:"sendTrackData",value:function(e){var t=this.$store.state.user.id,s=j["e"].firebase.database().ref("users/".concat(t,"/lastPlayed"));s.set(e)}},{key:"SpotifyAnalysisUtils",get:function(){return this.$store.state.spotifyAnalysisUtils}},{key:"accessToken",get:function(){return this.$store.state.accessToken}},{key:"playerInfo",get:function(){return this.$store.state.playerInfo}},{key:"user",get:function(){return this.$store.state.user}}]),s}(k["c"]);Ut=Object(p["__decorate"])([Object(k["a"])({components:{TrackItem:Ce,SeekTrack:Me,PlayerControls:Dt}})],Ut);var Mt=Ut,St=Mt,xt=(s("1e54"),Object(r["a"])(St,ve,be,!1,null,"27c94972",null)),It=xt.exports,Et=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"home-container-child"},[s("transition",{attrs:{name:"fade",mode:"out-in"}},[this.user?s("div",{key:"myPlaylistsTitle",staticClass:"playlists-title"},[s("h3",[e._v("Your Playlists")])]):e._e()]),s("transition",{attrs:{name:"fadeLeft",mode:"out-in"}},[this.userPlaylists?s("div",{key:"myPlaylistsContainer",staticClass:"playlists-container"},e._l(e.userPlaylists.items,(function(t,a){return s("div",{key:t+a},[s("UserPlaylist",{attrs:{playlistDetails:t,userID:e.user.id}})],1)})),0):s("div",[s("fingerprint-spinner",{attrs:{"animation-duration":1500,size:64,color:"#FFF"}})],1)])],1)},zt=[],Rt=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){var e;return Object(y["a"])(this,s),e=t.call(this),console.log("loaded playlists"),e.getThisUsersPlaylists(),e}return Object(m["a"])(s,[{key:"userPlaylists",get:function(){return this.$store.state.userPlaylists}},{key:"user",get:function(){return this.$store.state.user}}]),Object(m["a"])(s,[{key:"getThisUsersPlaylists",value:function(){var e=this;console.log("get"),k["c"].axios.get("https://api.spotify.com/v1/me/playlists",{headers:{Authorization:"Bearer "+this.$store.state.accessToken}}).then((function(t){console.log(t.data.items),e.$store.commit("mutateUserPlaylists",t.data)})).catch((function(e){console.log(e)}))}}]),s}(k["c"]);Rt=Object(p["__decorate"])([Object(k["a"])({components:{UserPlaylist:re,FingerprintSpinner:A["b"]}})],Rt);var Ft,Lt=Rt,qt=Lt,Kt=(s("f7a5"),Object(r["a"])(qt,Et,zt,!1,null,"978fe300",null)),Vt=Kt.exports,Bt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sceneContainer"},[s("div",{ref:"sceneRef",staticClass:"scene"})])},Ht=[],Wt=(s("99af"),s("4de4"),s("13d5"),s("ace4"),s("5cc6"),s("9a8c"),s("a975"),s("735e"),s("c1ac"),s("d139"),s("3a7b"),s("d5d6"),s("82f8"),s("e91f"),s("60bd"),s("5f96"),s("3280"),s("3fcc"),s("ca91"),s("25a1"),s("cd26"),s("3c5d"),s("2954"),s("649e"),s("219c"),s("170b"),s("b39a"),s("72f7"),function(){function e(){var t=this;Object(y["a"])(this,e),this.bassObject={bassDeviation:0,bassAv:0,bassArrCounter:0,bassEnergy:0,bassArr:[],lower:0,upper:4},this.kickObject={kickDeviation:0,kickAv:0,kickEnergy:0,kickArrCounter:0,kickArr:[],lower:1,upper:3},this.snareObject={snareDeviation:0,snareAv:0,snareEnergy:0,snareArrCounter:0,snareArr:[],lower:2,upper:4},this.midsObject={midsDeviation:0,midsAv:0,midsEnergy:0,midsArrCounter:0,midsArr:[],lower:4,upper:18},this.highsObject={highsDeviation:0,highsAv:0,highsEnergy:0,highsArrCounter:0,highsArr:[],lower:32,upper:128},this.avFreq=0,this.peak=0,this.rms=0,this.context=new AudioContext,this.analyser=this.context.createAnalyser(),this.analyser.fftSize=256,this.analyser.smoothingTimeConstant=.85,this.frequencyData=new Uint8Array(this.analyser.frequencyBinCount),this.bufferLength=this.analyser.frequencyBinCount,this.analyser.minDecibels=-90,this.analyser.maxDecibels=-25,this.source=null,navigator.mediaDevices.getUserMedia?(console.log("navigator.mediaDevices supported."),navigator.mediaDevices.enumerateDevices().then((function(e){e=e.filter((function(e){return"audiooutput"===e.kind})),console.log(e);var s={audio:{deviceId:"default"}};navigator.mediaDevices.getUserMedia(s).then((function(e){console.log(e),t.source=t.context.createMediaStreamSource(e),t.source.connect(t.analyser)}))})).catch((function(e){console.log("The following error occured: "+e)}))):console.log("getUserMedia not supported on your browser!")}return Object(m["a"])(e,[{key:"resetData",value:function(){this.bassObject.bassEnergy=0,this.kickObject.kickEnergy=0,this.snareObject.snareEnergy=0,this.midsObject.midsEnergy=0,this.highsObject.highsEnergy=0,this.avFreq=0,this.rms=0,this.peak=0,this.bassObject.bassAv=0,this.bassObject.bassDeviation=0,this.kickObject.kickAv=0,this.kickObject.kickDeviation=0,this.snareObject.snareAv=0,this.snareObject.snareDeviation=0,this.midsObject.midsAv=0,this.midsObject.midsDeviation=0,this.highsObject.highsAv=0,this.highsObject.highsDeviation=0}},{key:"getData",value:function(){this.resetData(),this.analyser.getByteFrequencyData(this.frequencyData),this.getBassData(),this.getKickData(),this.getSnareData(),this.getMidsData(),this.getHighsData(),this.getDeviations(),this.getAvFreq()}},{key:"getAvFreq",value:function(){for(var e=0;e<this.bufferLength;e++)this.avFreq+=this.frequencyData[e],this.rms+=this.frequencyData[e]*this.frequencyData[e],this.frequencyData[e]>this.peak&&(this.peak=this.frequencyData[e]);this.avFreq=this.avFreq/this.bufferLength,this.rms=Math.sqrt(this.rms/this.bufferLength)}},{key:"getBassData",value:function(){for(var e=this.bassObject.lower;e<this.bassObject.upper;e++)this.bassObject.bassEnergy+=this.frequencyData[e];this.bassObject.bassEnergy=this.bassObject.bassEnergy/(this.bassObject.upper-this.bassObject.lower),this.bassObject.bassArr[this.bassObject.bassArrCounter++]=this.bassObject.bassEnergy,this.bassObject.bassArrCounter>=32&&(this.bassObject.bassArrCounter=0)}},{key:"getKickData",value:function(){for(var e=this.kickObject.lower;e<this.kickObject.upper;e++)this.kickObject.kickEnergy+=this.frequencyData[e];this.kickObject.kickEnergy=this.kickObject.kickEnergy/(this.kickObject.upper-this.kickObject.lower),this.kickObject.kickArr[this.kickObject.kickArrCounter++]=this.kickObject.kickEnergy,this.kickObject.kickArrCounter>=32&&(this.kickObject.kickArrCounter=0)}},{key:"getSnareData",value:function(){for(var e=this.snareObject.lower;e<this.snareObject.upper;e++)this.snareObject.snareEnergy+=this.frequencyData[e];this.snareObject.snareEnergy=this.snareObject.snareEnergy/(this.snareObject.upper-this.snareObject.lower),this.snareObject.snareArr[this.snareObject.snareArrCounter++]=this.snareObject.snareEnergy,this.snareObject.snareArrCounter>=32&&(this.snareObject.snareArrCounter=0)}},{key:"getMidsData",value:function(){for(var e=this.midsObject.lower;e<this.midsObject.upper;e++)this.midsObject.midsEnergy+=this.frequencyData[e];this.midsObject.midsEnergy=this.midsObject.midsEnergy/(this.midsObject.upper-this.midsObject.lower),this.midsObject.midsArr[this.midsObject.midsArrCounter++]=this.midsObject.midsEnergy,this.midsObject.midsArrCounter>=32&&(this.midsObject.midsArrCounter=0)}},{key:"getHighsData",value:function(){for(var e=this.highsObject.lower;e<this.highsObject.upper;e++)this.highsObject.highsEnergy+=this.frequencyData[e];this.highsObject.highsEnergy=this.highsObject.highsEnergy/(this.highsObject.upper-this.highsObject.lower),this.highsObject.highsArr[this.highsObject.highsArrCounter++]=this.highsObject.highsEnergy,this.highsObject.highsArrCounter>=32&&(this.highsObject.highsArrCounter=0)}},{key:"getDeviations",value:function(){for(var e=0;e<this.bassObject.bassArr.length;e++)this.bassObject.bassAv+=this.bassObject.bassArr[e],this.bassObject.bassDeviation+=this.bassObject.bassArr[e]*this.bassObject.bassArr[e],this.kickObject.kickAv+=this.kickObject.kickArr[e],this.kickObject.kickDeviation+=this.kickObject.kickArr[e]*this.kickObject.kickArr[e],this.snareObject.snareAv+=this.snareObject.snareArr[e],this.snareObject.snareDeviation+=this.snareObject.snareArr[e]*this.snareObject.snareArr[e],this.midsObject.midsAv+=this.midsObject.midsArr[e],this.midsObject.midsDeviation+=this.midsObject.midsArr[e]*this.midsObject.midsArr[e],this.highsObject.highsAv+=this.highsObject.highsArr[e],this.highsObject.highsDeviation+=this.highsObject.highsArr[e]*this.highsObject.highsArr[e];this.bassObject.bassAv=this.bassObject.bassAv/this.bassObject.bassArr.length,this.bassObject.bassDeviation=Math.sqrt(this.bassObject.bassDeviation/this.bassObject.bassArr.length-this.bassObject.bassAv*this.bassObject.bassAv),this.kickObject.kickAv=this.kickObject.kickAv/this.kickObject.kickArr.length,this.kickObject.kickDeviation=Math.sqrt(this.kickObject.kickDeviation/this.kickObject.kickArr.length-this.kickObject.kickAv*this.kickObject.kickAv),this.snareObject.snareAv=this.snareObject.snareAv/this.snareObject.snareArr.length,this.snareObject.snareDeviation=Math.sqrt(this.snareObject.snareDeviation/this.snareObject.snareArr.length-this.snareObject.snareAv*this.snareObject.snareAv),this.midsObject.midsAv=this.midsObject.midsAv/this.midsObject.midsArr.length,this.midsObject.midsDeviation=Math.sqrt(this.midsObject.midsDeviation/this.midsObject.midsArr.length-this.midsObject.midsAv*this.midsObject.midsAv),this.highsObject.highsAv=this.highsObject.highsAv/this.highsObject.highsArr.length,this.highsObject.highsDeviation=Math.sqrt(this.highsObject.highsDeviation/this.highsObject.highsArr.length-this.highsObject.highsAv*this.highsObject.highsAv)}}]),e}()),Zt=s("5a89"),Nt=s("16ed"),Gt=s.n(Nt),Jt=s("32d9"),Xt=s("93e9"),Yt=s("5b17"),Qt=Ft=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){var e;return Object(y["a"])(this,s),e=t.call(this),Ft.liveAudio=new Wt,Ft.noise=new Gt.a,Ft.camera=new Zt["n"],Ft.renderer=new Zt["A"]({antialias:!0}),Ft.scene=new Zt["r"],Ft.shapeArr=[],Ft.shapeMax=529,Ft.layerMarker=[],Ft.shapeColour="#FFF",Ft.freqKey=4,Ft.spinConstants=[.03,.015,.075,.0025,.001],e.rotateShapeToggle=!1,e}return Object(m["a"])(s,[{key:"mounted",value:function(){0===Ft.shapeArr.length&&(console.log("Empty visualizer"),this.setupVisualizer()),this.$store.commit("mutateModeKey",1),this.$store.commit("mutateColourKey",1),this.$gtag.pageview({page_title:"Visualizer",page_path:"/visualizer",page_location:"/visualizer"})}},{key:"beforeDestroy",value:function(){this.removeShape(),cancelAnimationFrame(this.animationID)}},{key:"setupVisualizer",value:function(){var e=this;this.changingMode=!0;var t=this.$refs.sceneRef;this.$nextTick((function(){Ft.camera=new Zt["n"](75,t.clientWidth/t.clientHeight,.1,1e3),Ft.renderer.setSize(t.clientWidth,t.clientHeight),Ft.camera.aspect=t.clientWidth/t.clientHeight,console.log(t.children),t.appendChild(Ft.renderer.domElement),e.canvasResizeListener(t),e.addLighting(),e.addOcean(),Ft.camera.position.z=90,Ft.composer=new Jt["a"](Ft.renderer),Ft.composer.addPass(new Xt["a"](Ft.scene,Ft.camera));var s=new Yt["a"];Ft.composer.addPass(s),e.changingMode=!1,e.animate()}))}},{key:"animate",value:function(){this.animationID=requestAnimationFrame(this.animate),this.renderer()}},{key:"renderer",value:function(){if(this.SpotifyAnalysisUtils.loaded){if(Ft.liveAudio.getData(),this.PlayerInfo.paused||this.changingMode)console.log("pausing player");else if(this.RandomColour&&this.changeColourKey(),this.RandomMode&&this.changeModeKey(),this.setColour(this.ColourKey,this.SpotifyAnalysisUtils),this.CameraRotateToggle&&this.rotateCamera(),this.CameraZoomToggle&&this.zoomCamera(),this.doMode(this.ModeKey,this.SpotifyAnalysisUtils),this.rotateShapeToggle)for(var e=0;e<Ft.shapeArr.length;e++)this.rotateShape(Ft.shapeArr[e])}else console.log("no track features");Ft.camera.updateProjectionMatrix(),this.ModeKey>2?(Ft.composer.passes[1].uniforms.damp.value=Math.min(.92,Ft.liveAudio.kickObject.kickEnergy/255),Ft.composer.render()):(Ft.composer.passes[1].uniforms.damp.value=Math.min(.82,Ft.liveAudio.bassObject.bassEnergy/255),Ft.composer.render())}},{key:"mode4",value:function(e){if(e.barCounter>3){for(var t=Ft.layerMarker[e.beatCounter-4];t<Ft.layerMarker[e.beatCounter-3];t++)this.changeColour(Ft.shapeArr[t],"0x0000");for(var s=Ft.layerMarker[e.beatCounter-2];s<Ft.layerMarker[e.beatCounter];s++)this.changeColour(Ft.shapeArr[s],Ft.shapeColour)}else{if(0!==e.beatCounter)for(var a=Ft.layerMarker[e.beatCounter-1];a<Ft.layerMarker[e.beatCounter];a++)this.changeColour(Ft.shapeArr[a],Ft.shapeColour);this.changeColour(Ft.shapeArr[0],Ft.shapeColour)}e.beatCounter>Ft.layerMarker.length-1&&(e.beatCounter=0)}},{key:"mode5",value:function(e){if(e.beatCounter>3){for(var t=Ft.layerMarker[e.beatCounter-4];t<Ft.layerMarker[e.beatCounter-3];t+=2)this.changeColour(Ft.shapeArr[t],"0x0000");for(var s=Ft.layerMarker[e.beatCounter-2];s<Ft.layerMarker[e.beatCounter];s+=2)this.changeColour(Ft.shapeArr[s],Ft.shapeColour)}else if(0!==e.beatCounter)for(var a=Ft.layerMarker[e.beatCounter-1];a<Ft.layerMarker[e.beatCounter];a+=2)this.changeColour(Ft.shapeArr[a],Ft.shapeColour);else this.changeColour(Ft.shapeArr[0],Ft.shapeColour);e.beatCounter>Ft.layerMarker.length-1&&(e.beatCounter=0)}},{key:"mode1",value:function(e){var t=64;t=e.trackFeatures.valence>.7?(Ft.liveAudio.bassObject.bassAv-Ft.liveAudio.highsObject.highsAv)/(e.trackFeatures.energy*e.trackFeatures.danceability*e.trackFeatures.valence):e.trackFeatures.valence>.4?(Ft.liveAudio.bassObject.bassAv+Ft.liveAudio.kickObject.kickAv-Ft.liveAudio.midsObject.midsAv)/e.trackFeatures.energy:this.SpotifyAnalysisUtils.trackFeatures.valence>.1?(Ft.liveAudio.bassObject.bassAv+Ft.liveAudio.kickObject.kickAv-Ft.liveAudio.highsObject.highsEnergy)/e.trackFeatures.danceability:(Ft.liveAudio.bassObject.bassAv+Ft.liveAudio.kickObject.kickAv-Ft.liveAudio.midsObject.midsAv-Ft.liveAudio.highsObject.highsEnergy)/e.trackFeatures.energy;for(var s=e.trackFeatures.energy*e.trackFeatures.danceability*(Ft.liveAudio.rms+Ft.liveAudio.highsObject.highsEnergy)*(1.5-e.trackFeatures.valence),a=(Date.now()+Ft.liveAudio.bassObject.bassEnergy+Ft.liveAudio.kickObject.kickEnergy)/(e.trackFeatures.tempo*e.trackFeatures.danceability*e.trackFeatures.energy*20),i=Ft.shapeArr[0].geometry,n=i.getAttribute("position"),r=0;r<n.count;r++){var o=Ft.calcPlanePosition(n.getX(r),n.getY(r),t,a);n.setZ(r,o*s)}if(i.setAttribute("position",n),n.needsUpdate=!0,i.computeVertexNormals(),this.changeColour(Ft.shapeArr[0],Ft.shapeColour),e.barCounter>=1){var c=Ft.shapeArr[0].material;c.wireframe=!c.wireframe,c.flatShading=!c.wireframe,e.barCounter=0}}},{key:"mode2",value:function(e){var t=!1;if(Ft.shapeArr.length>0&&(t=Ft.shapeArr[0].material.wireframe),this.removeShape(),this.addGenerativeSphere(e,t),e.barCounter>=1){var s=Ft.shapeArr[0].material;s.wireframe=!s.wireframe,s.flatShading=!s.wireframe,e.barCounter=0}this.changeColour(Ft.shapeArr[0],Ft.shapeColour)}},{key:"mode3",value:function(e){if(e.tatumCounter%Ft.shapeArr.length===0)for(var t=0;t<Ft.shapeArr.length;t++)this.changeColour(Ft.shapeArr[t],"0x0000");for(var s=0;s<1+e.tatumCounter%Ft.shapeArr.length;s++)this.changeColour(Ft.shapeArr[s],Ft.shapeColour)}},{key:"doMode",value:function(e,t){switch(e){case 1:this.mode1(t);break;case 2:this.mode2(t);break;case 3:this.mode3(t);break;case 4:this.mode4(t);break;case 5:this.mode5(t);break;default:this.$store.commit("mutateModeKey",1),this.mode1(t)}}},{key:"zoomCamera",value:function(){var e=this.SpotifyAnalysisUtils.g_beats[this.SpotifyAnalysisUtils.g_beat].confidence,t=this.SpotifyAnalysisUtils.g_beats[this.SpotifyAnalysisUtils.g_beat].start+this.SpotifyAnalysisUtils.g_beats[this.SpotifyAnalysisUtils.g_beat].duration,s=(Math.asin(Ft.liveAudio.bassObject.bassEnergy/255)*(1+this.SpotifyAnalysisUtils.trackFeatures.danceability)+Math.asin(Ft.liveAudio.bassObject.bassAv/255))*this.SpotifyAnalysisUtils.trackFeatures.energy;this.ModeKey>1&&s>.8?e>.9?this.SpotifyAnalysisUtils.g_bar%2===0?Ft.camera.zoom=s*(1-(this.TrackTime/1e3-t)):Ft.camera.zoom=s*(this.TrackTime/1e3-t):Ft.camera.zoom=s:Ft.camera.zoom=.8}},{key:"rotateCamera",value:function(){var e=15e3,t=Date.now()/(15e3*(1-this.SpotifyAnalysisUtils.trackFeatures.energy)),s=Ft.noise.noise2D(t-e,t)/2,a=Ft.noise.noise2D(t,t+e)/3,i=0;this.ModeKey>1?(this.SpotifyAnalysisUtils.g_beats[this.SpotifyAnalysisUtils.g_beat]&&this.SpotifyAnalysisUtils.g_beats[this.SpotifyAnalysisUtils.g_beat].confidence>.85&&(i=this.SpotifyAnalysisUtils.barCounter%2===0?this.SpotifyAnalysisUtils.trackFeatures.tempo*Ft.liveAudio.bassObject.bassAv/5e5:-this.SpotifyAnalysisUtils.trackFeatures.tempo*Ft.liveAudio.bassObject.bassAv/5e5),Ft.camera.rotation.set(a,s,Ft.camera.rotation.z),Ft.camera.rotateZ(i)):Ft.camera.rotation.set(0,0,0)}},{key:"rotateShape",value:function(e){var t=Ft.liveAudio.frequencyData[Ft.freqKey];t>150?t>200?(e.rotation.x-=Ft.spinConstants[1],e.rotation.y-=Ft.spinConstants[0],e.rotation.z-=Ft.spinConstants[1]):(e.rotation.x-=Ft.spinConstants[2],e.rotation.y-=Ft.spinConstants[1],e.rotation.z-=Ft.spinConstants[2]):t>100?(e.rotation.x-=Ft.spinConstants[3],e.rotation.y+=Ft.spinConstants[1],e.rotation.z-=Ft.spinConstants[4]):(e.rotation.x-=Ft.spinConstants[4],e.rotation.y+=Ft.spinConstants[2],e.rotation.z-=Ft.spinConstants[3])}},{key:"changeColour",value:function(e,t){if(e.material instanceof Zt["f"]){var s=new Zt["c"](parseInt(t)),a={color:s};e.material.setValues(a)}}},{key:"setColour",value:function(e,t){switch(e){case 1:Ft.shapeColour=this.hslToHex(2*t.g_timbre[2],2*t.g_timbre[1],2*t.g_timbre[0]);break;case 2:Ft.shapeColour=this.hslToHex(2*(1-t.g_timbre[2]),2*t.g_timbre[1],2*t.g_timbre[0]);break;case 3:Ft.shapeColour=this.hslToHex(Ft.liveAudio.snareObject.snareEnergy,Ft.liveAudio.bassObject.bassAv,t.g_timbre[0]);break;case 4:Ft.shapeColour=this.rgbToHex(Ft.liveAudio.highsObject.highsEnergy,Ft.liveAudio.midsObject.midsEnergy,Ft.liveAudio.snareObject.snareEnergy);break;case 5:Ft.shapeColour=this.hslToHex(Ft.liveAudio.bassObject.bassEnergy,Ft.liveAudio.bassObject.bassAv+Ft.liveAudio.highsObject.highsEnergy,Ft.liveAudio.midsObject.midsEnergy);break;case 6:Ft.shapeColour=this.rgbToHex(Ft.liveAudio.snareObject.snareAv,Ft.liveAudio.avFreq/2,Ft.liveAudio.avFreq/2);break;case 7:Ft.shapeColour=this.rgbToHex(Ft.liveAudio.rms,Ft.liveAudio.avFreq,Ft.liveAudio.peak);break;case 8:Ft.shapeColour=this.rgbToHex(Ft.liveAudio.peak,Ft.liveAudio.avFreq,Ft.liveAudio.rms);break;case 9:Ft.shapeColour=this.rgbToHex(2*Ft.liveAudio.avFreq,Ft.liveAudio.avFreq/10,3*Ft.liveAudio.avFreq);break;case 10:Ft.shapeColour=this.rgbToHex(Ft.liveAudio.frequencyData[13],Ft.liveAudio.frequencyData[9],Ft.liveAudio.frequencyData[5]);break;case 11:Ft.shapeColour=this.hslToHex(Ft.liveAudio.highsObject.highsEnergy*Ft.liveAudio.avFreq,Ft.liveAudio.bassObject.bassEnergy,Ft.liveAudio.midsObject.midsEnergy);break;case 12:Ft.shapeColour=this.hslToHex(360-Ft.liveAudio.highsObject.highsEnergy*Ft.liveAudio.avFreq,Ft.liveAudio.bassObject.bassEnergy,Ft.liveAudio.midsObject.midsEnergy);break;default:Ft.shapeColour=this.rgbToHex(Ft.liveAudio.frequencyData[4],Ft.liveAudio.frequencyData[8],Ft.liveAudio.frequencyData[12])}}},{key:"setShapePosition",value:function(){var e=0,t=1,s=0,a=0,i=0,n=25,r=0,o=12;for(Ft.shapeArr[r++].position.set(s,a,i),s+=n,Ft.layerMarker[0]=1,t;t<o;t++){for(e=1;e<2*t;e++)Ft.shapeArr[r++].position.set(s,a,i),a-=n;for(e=0;e<2*t;e++)Ft.shapeArr[r++].position.set(s,a,i),s-=n;for(e=0;e<2*t;e++)Ft.shapeArr[r++].position.set(s,a,i),a+=n;for(e=-1;e<2*t;e++)Ft.shapeArr[r++].position.set(s,a,i),s+=n;Ft.layerMarker[t]=r,console.log(r),i-=n}console.log(Ft.layerMarker)}},{key:"removeShape",value:function(){console.log("removing shapes");for(var e=0;e<Ft.shapeArr.length;e++){Ft.scene.remove(Ft.shapeArr[e]),Ft.shapeArr[e].geometry.dispose();var t=Ft.shapeArr[e].material;t.dispose()}Ft.shapeArr=[]}},{key:"addOcean",value:function(){Ft.shapeArr.push(new Zt["g"](new Zt["o"](window.innerWidth,window.innerWidth,256,256),new Zt["i"])),console.log(Ft.shapeArr),Ft.shapeArr[0].rotation.set(-Math.PI/4,0,Math.PI/2),Ft.shapeArr[0].position.set(0,0,-250),Ft.scene.add(Ft.shapeArr[0]),console.log("added ocean")}},{key:"addGenerativeSphere",value:function(e,t){var s=1,a=e.g_pitches.filter((function(e){return e>.5}));a.length>0&&(s=a.reduce((function(e,t){return e+t}))),Ft.shapeArr.push(new Zt["g"](new Zt["t"](50,Math.ceil(3*s),Math.ceil(3*s),0,2*Math.PI,Math.sin(e.trackFeatures.tempo*this.TrackTime/1e6)*Math.PI*2,Ft.liveAudio.rms/255*6),new Zt["j"]({wireframe:t,flatShading:!t}))),Ft.shapeArr[0].rotation.set(Math.PI/2,0,0),Ft.scene.add(Ft.shapeArr[0]),console.log(Ft.shapeArr[0].geometry.parameters.thetaStart),console.log(Ft.shapeArr[0].geometry.parameters.thetaLength)}},{key:"addShape",value:function(e){if(0===e){for(var t=new Zt["a"](10,10,10),s=0;s<Ft.shapeMax;s++)Ft.shapeArr.push(new Zt["g"](t,new Zt["i"]({color:0}))),Ft.scene.add(Ft.shapeArr[s]);console.log("added new cube grid")}else if(1===e){for(var a=new Zt["l"](10,0),i=0;i<Ft.shapeMax;i++)Ft.shapeArr.push(new Zt["g"](a,new Zt["i"]({color:0}))),Ft.scene.add(Ft.shapeArr[i]);console.log("added new octa grid")}else if(2===e){for(var n=new Zt["u"](5,32,32),r=0;r<Ft.shapeMax;r++)Ft.shapeArr.push(new Zt["g"](n,new Zt["i"]({color:0}))),Ft.scene.add(Ft.shapeArr[r]);console.log("added new sphere grid")}else if(3===e){for(var o=new Zt["w"](10,0),c=0;c<Ft.shapeMax;c++)Ft.shapeArr.push(new Zt["g"](o,new Zt["i"]({color:0}))),Ft.scene.add(Ft.shapeArr[c]);console.log("added new tetra grid")}else{for(var l=new Zt["d"](10,0),u=0;u<Ft.shapeMax;u++)Ft.shapeArr.push(new Zt["g"](l,new Zt["i"]({color:0}))),Ft.scene.add(Ft.shapeArr[u]);console.log("added new dodeca grid")}}},{key:"addLighting",value:function(){var e=new Zt["p"](16777215),t=new Zt["v"](16777215);e.position.set(0,500,600),Ft.scene.add(e),t.position.set(0,-window.innerHeight/2,window.innerHeight/8),t.castShadow=!0,t.shadow.mapSize.width=window.innerWidth,t.shadow.mapSize.height=window.innerHeight,t.shadow.camera.near=500,t.shadow.camera.far=4e3,t.shadow.camera.fov=30,Ft.scene.add(t)}},{key:"rgbToHexHelper",value:function(e){var t=Math.ceil(e).toString(16);return 1===t.length?"0"+t:t}},{key:"rgbToHex",value:function(e,t,s){return"0x"+this.rgbToHexHelper(e)+this.rgbToHexHelper(t)+this.rgbToHexHelper(s)}},{key:"hslToHex",value:function(e,t,s){var a,i,n;if(e/=360,t/=255,s/=255,0===t)a=i=n=s;else{var r=function(e,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+6*(t-e)*s:s<.5?t:s<2/3?e+(t-e)*(2/3-s)*6:e},o=s<.5?s*(1+t):s+t-s*t,c=2*s-o;a=r(c,o,e+1/3),i=r(c,o,e),n=r(c,o,e-1/3)}var l=function(e){var t=Math.round(255*e).toString(16);return 1===t.length?"0"+t:t};return"0x".concat(l(a)).concat(l(i)).concat(l(n))}},{key:"canvasResizeListener",value:function(e){e.addEventListener("onresize",(function(t){var s=e.clientWidth,a=e.clientHeight;Ft.renderer.setSize(s,a),Ft.camera.aspect=s/a,Ft.camera.updateProjectionMatrix()}))}},{key:"onModeKeyChanged",value:function(e,t){console.log("changing mode key to ".concat(e," from ").concat(t)),e&&(this.changingMode=!0,this.removeShape(),e>2?(this.addShape(Math.floor(5*Math.random())),this.setShapePosition(),this.rotateShapeToggle=!0,Ft.scene.children[1].position.set(0,-window.innerHeight/2,90)):1===e?(this.addOcean(),Ft.noise=new Gt.a,this.rotateShapeToggle=!1,Ft.scene.children[1].position.set(0,-window.innerHeight/2,90)):2===e&&(this.addGenerativeSphere(this.SpotifyAnalysisUtils,!1),Ft.scene.children[1].position.set(0,-window.innerHeight/4,0),this.rotateShapeToggle=!1),this.changingMode=!1,console.log(Ft.scene.children[1]))}},{key:"changeColourKey",value:function(){if(this.SpotifyAnalysisUtils.changeColour){var e=Math.floor(9*Math.random());this.$store.commit("mutateColourKey",e),this.SpotifyAnalysisUtils.changeColour=!1,console.log("changing colour key to ".concat(e))}}},{key:"changeModeKey",value:function(){if(this.SpotifyAnalysisUtils.changeMode){var e=Math.floor(1+5*Math.random());this.$store.commit("mutateModeKey",e),this.SpotifyAnalysisUtils.changeMode=!1,console.log("changing mode key to ".concat(e))}}},{key:"CameraZoomToggle",get:function(){return this.$store.state.cameraZoomToggle}},{key:"CameraRotateToggle",get:function(){return this.$store.state.cameraRotateToggle}},{key:"RandomMode",get:function(){return this.$store.state.randomMode}},{key:"RandomColour",get:function(){return this.$store.state.randomMode}},{key:"ModeKey",get:function(){return this.$store.state.modeKey}},{key:"ColourKey",get:function(){return this.$store.state.colourKey}},{key:"SpotifyAnalysisUtils",get:function(){return this.$store.state.spotifyAnalysisUtils}},{key:"accessToken",get:function(){return this.$store.state.accessToken}},{key:"PlayerInfo",get:function(){return this.$store.state.playerInfo}},{key:"TrackTime",get:function(){return this.$store.state.trackPosition}}],[{key:"calcPlanePosition",value:function(e,t,s,a){return Ft.noise.noise3D(e/s,t/s,a)}}]),s}(k["c"]);Object(p["__decorate"])([Object(k["d"])("ModeKey")],Qt.prototype,"onModeKeyChanged",null),Qt=Ft=Object(p["__decorate"])([k["a"]],Qt);var es=Qt,ts=es,ss=(s("f17b"),Object(r["a"])(ts,Bt,Ht,!1,null,"73099b5e",null)),as=ss.exports,is=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"controls-container"},[s("transition",{attrs:{name:"fadeRight",mode:"out-in"}},[this.isOpen?s("div",{key:"OpenVisualizerControls",staticClass:"child"},[s("div",{staticClass:"controls"},[s("button",{staticClass:"btn close",on:{click:e.closeVis}},[e._v("close visualizer")]),s("div",[e._v(" Mode: "),s("strong",[e._v(e._s(this.ModeKey))])]),s("div",[e._v(" Colour: "),s("strong",[e._v(e._s(this.ColourKey))])]),s("button",{staticClass:"btn toggle",class:{on:this.RandomMode},on:{click:e.toggleRandomMode}},[e._v(" Randomize Mode ")]),s("button",{staticClass:"btn toggle",class:{on:this.RandomColour},on:{click:e.toggleRandomColour}},[e._v(" Randomize Colour ")]),this.ModeKey>1?s("button",{staticClass:"btn toggle",class:{on:this.CameraZoomToggle},on:{click:e.toggleCameraZoom}},[e._v(" Camera Zoom ")]):e._e(),this.ModeKey>1?s("button",{staticClass:"btn toggle",class:{on:this.CameraRotateToggle},on:{click:e.toggleCameraRotate}},[e._v(" Camera Rotate ")]):e._e(),s("button",{staticClass:"btn close",on:{click:e.hideControls}},[e._v(" hide controls ")])])]):s("div",{key:"CloseVisualizerControls",staticClass:"child closed"},[s("div",{staticClass:"hidden-controls-container"},[s("a",{on:{click:e.showControls}},[e._v(" > ")])])])])],1)},ns=[],rs=function(e){Object(b["a"])(s,e);var t=Object(v["a"])(s);function s(){var e;return Object(y["a"])(this,s),e=t.call(this),e.isOpen=!1,e}return Object(m["a"])(s,[{key:"toggleCameraZoom",value:function(){this.$store.commit("mutateCameraZoomToggle",!this.CameraZoomToggle)}},{key:"toggleCameraRotate",value:function(){this.$store.commit("mutateCameraRotateToggle",!this.CameraRotateToggle)}},{key:"toggleRandomMode",value:function(){this.$store.commit("mutateRandomMode",!this.RandomMode)}},{key:"toggleRandomColour",value:function(){this.$store.commit("mutateRandomColour",!this.RandomColour)}},{key:"closeVis",value:function(){this.$store.commit("mutateOpenVisualizer",!1)}},{key:"hideControls",value:function(){this.isOpen=!1,console.log(this.isOpen)}},{key:"showControls",value:function(){this.isOpen=!0,console.log(this.isOpen)}},{key:"mounted",value:function(){window.addEventListener("keypress",this.doCommand)}},{key:"beforeDestroy",value:function(){window.removeEventListener("keypress",this.doCommand)}},{key:"doCommand",value:function(e){var t=e.key.toLowerCase();console.log(t),0===parseInt(t)?this.$store.commit("mutateModeKey",0):1===parseInt(t)?this.$store.commit("mutateModeKey",1):2===parseInt(t)?this.$store.commit("mutateModeKey",2):3===parseInt(t)?this.$store.commit("mutateModeKey",3):4===parseInt(t)?this.$store.commit("mutateModeKey",4):5===parseInt(t)?this.$store.commit("mutateModeKey",5):"q"===t?this.$store.commit("mutateColourKey",1):"a"===t?this.$store.commit("mutateColourKey",2):"z"===t?this.$store.commit("mutateColourKey",3):"w"===t?this.$store.commit("mutateColourKey",4):"s"===t?this.$store.commit("mutateColourKey",5):"x"===t?this.$store.commit("mutateColourKey",6):"e"===t?this.$store.commit("mutateColourKey",7):"d"===t?this.$store.commit("mutateColourKey",8):"c"===t&&this.$store.commit("mutateColourKey",10)}},{key:"CameraZoomToggle",get:function(){return this.$store.state.cameraZoomToggle}},{key:"CameraRotateToggle",get:function(){return this.$store.state.cameraRotateToggle}},{key:"RandomMode",get:function(){return this.$store.state.randomMode}},{key:"RandomColour",get:function(){return this.$store.state.randomColour}},{key:"ModeKey",get:function(){return this.$store.state.modeKey}},{key:"ColourKey",get:function(){return this.$store.state.colourKey}}]),s}(k["c"]);rs=Object(p["__decorate"])([k["a"]],rs);var os=rs,cs=os,ls=(s("d933"),Object(r["a"])(cs,is,ns,!1,null,"1acd4982",null)),us=ls.exports,hs={name:"Home",components:{Login:P,OnlineUsers:me,Player:It,MyPlaylists:Vt,VisualizerCanvas:as,VisualizerControls:us}},ds=hs,fs=Object(r["a"])(ds,h,d,!1,null,null,null),gs=fs.exports;a["a"].use(u["a"]);var ys=[{path:"/",name:"Home",component:gs},{path:"/dashboard",name:"Dashboard",component:function(){return s.e("chunk-2d0d63f1").then(s.bind(null,"7277"))}},{path:"/about",name:"About",component:function(){return s.e("about").then(s.bind(null,"f820"))}},{path:"/community",name:"Community",component:function(){return s.e("Community").then(s.bind(null,"8838"))}}],ms=new u["a"]({mode:"history",base:"/",routes:ys}),vs=ms,bs=(s("96cf"),s("1da1")),ps=s("2f62");a["a"].use(ps["a"]);var ks=new ps["a"].Store({state:{accessToken:null,refreshToken:null,user:null,authUser:null,openVisualizer:!1,onlineUsers:null,lastOnlineUsers:null,deviceID:null,playerInfo:null,trackPosition:null,topTracks:null,topArtists:null,userPlaylists:null,usersPlaylists:new Map,toggleUsersPlaylists:new Map,spotifyAnalysisUtils:null,modeKey:1,colourKey:1,randomMode:!0,randomColour:!0,cameraZoomToggle:!0,cameraRotateToggle:!0},mutations:{mutateAccessToken:function(e,t){e.accessToken=t},mutateRefreshToken:function(e,t){e.refreshToken=t},mutateUser:function(e,t){e.user=t},mutateAuthUser:function(e,t){e.authUser=t},mutateOpenVisualizer:function(e,t){e.openVisualizer=t},mutateOnlineUsers:function(e,t){e.onlineUsers=t},mutateLastOnlineUsers:function(e,t){e.lastOnlineUsers=t},mutateDeviceID:function(e,t){e.deviceID=t},mutatePlayerInfo:function(e,t){e.playerInfo=t},mutateTrackPosition:function(e,t){e.trackPosition=t},mutateTopTracks:function(e,t){e.topTracks=t},mutateTopArtists:function(e,t){e.topArtists=t},mutateUserPlaylists:function(e,t){e.userPlaylists=t},mutateUsersPlaylists:function(e,t){var s=e.usersPlaylists.set(t.key,t.value);e.usersPlaylists=new Map,e.usersPlaylists=s},mutateSpotifyAnalysisUtils:function(e,t){e.spotifyAnalysisUtils=t},mutateModeKey:function(e,t){e.modeKey=t},mutateColourKey:function(e,t){e.colourKey=t},mutateRandomMode:function(e,t){e.randomMode=t},mutateRandomColour:function(e,t){e.randomColour=t},mutateCameraZoomToggle:function(e,t){e.cameraZoomToggle=t},mutateCameraRotateToggle:function(e,t){e.cameraRotateToggle=t}},getters:{getAccessToken:function(e){return e.accessToken},getRefreshToken:function(e){return e.refreshToken},getUser:function(e){return e.user},getAuthUser:function(e){return e.authUser},getOnlineUsers:function(e){return e.onlineUsers},getLastOnlineUsers:function(e){return e.lastOnlineUsers},getDeviceID:function(e){return e.deviceID},getPlayerInfo:function(e){return e.playerInfo},getTopTracks:function(e){return e.topTracks},getTopArtists:function(e){return e.topArtists},getUsersPlaylists:function(e){return e.usersPlaylists},getToggleUsersPlaylists:function(e){return e.toggleUsersPlaylists}},actions:{actionAuthUser:function(e,t){return Object(bs["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.t0=e,s.next=3,Object(j["d"])(t);case 3:s.t1=s.sent,s.t0.commit.call(s.t0,"mutateAuthUser",s.t1);case 5:case"end":return s.stop()}}),s)})))()}},modules:{}}),Os=s("a7fe"),js=s.n(Os),As=s("a584");a["a"].use(js.a,wt.a),a["a"].use(As["a"],{config:{id:"UA-133459521-1"}},vs),a["a"].config.productionTip="production",new a["a"]({router:vs,store:ks,render:function(e){return e(l)}}).$mount("#app")},d235:function(e,t,s){"use strict";var a=s("badc"),i=s.n(a);i.a},d933:function(e,t,s){"use strict";var a=s("796c"),i=s.n(a);i.a},f124:function(e,t,s){},f17b:function(e,t,s){"use strict";var a=s("34ee"),i=s.n(a);i.a},f7a5:function(e,t,s){"use strict";var a=s("67c3"),i=s.n(a);i.a},f7f0:function(e,t,s){},fc3e:function(e,t,s){}});
//# sourceMappingURL=app.23db7858.js.map